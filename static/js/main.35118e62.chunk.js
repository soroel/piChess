(this["webpackJsonpapp-platform-demo-frontend"]=this["webpackJsonpapp-platform-demo-frontend"]||[]).push([[0],[,,,,,,,,,,function(e,o,c){},function(e,o,c){},function(e,o,c){},,function(e,o,c){},function(e,o,c){},function(e,o,c){},function(e,o,c){},function(e,o,c){},function(e,o,c){"use strict";c.r(o);var t=c(1),r=c.n(t),n=c(4),i=c.n(n),l=(c(9),c(10),c(2)),s=(c(11),c(12),c(0));const a={queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"}},p={queen:"Moves any number of squares diagonally, horizontally, or vertically",rook:"Moves any number of squares horizontally or vertically",bishop:"Moves any number of squares diagonally",knight:"Moves in an L-shape: 2 squares in one direction and 1 square perpendicular"};var u=e=>{let{color:o,position:c,onSelect:r}=e;return Object(t.useEffect)((()=>{const e=e=>{"Escape"===e.key&&r("queen")};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[r]),Object(s.jsx)("div",{className:"promotion-overlay",children:Object(s.jsxs)("div",{className:"promotion-dialog",style:{position:"absolute",left:"".concat(c.x,"px"),top:"".concat(c.y,"px"),transform:"translate(-50%, -50%)",animation:"slideIn 0.3s ease-out"},role:"dialog","aria-modal":"true","aria-label":"Pawn promotion selection",children:[Object(s.jsx)("div",{className:"promotion-header",children:"Choose a piece for promotion"}),Object(s.jsx)("div",{className:"promotion-options",children:["queen","rook","bishop","knight"].map((e=>Object(s.jsxs)("button",{className:"promotion-option",onClick:()=>r(e),title:p[e],"aria-label":"Promote to ".concat(e),children:[Object(s.jsx)("div",{className:"piece-symbol",children:a[e][o]}),Object(s.jsx)("div",{className:"piece-name",children:e.toUpperCase()})]},e)))}),Object(s.jsx)("div",{className:"promotion-footer",children:"Press ESC to cancel (default: Queen)"})]})})};c(14);var h=e=>{let{winner:o,onNewGame:c}=e;return Object(s.jsx)("div",{className:"checkmate-overlay",children:Object(s.jsx)("div",{className:"checkmate-popup",children:Object(s.jsxs)("div",{className:"checkmate-content",children:[Object(s.jsx)("h2",{children:"Checkmate!"}),Object(s.jsxs)("p",{children:[o.charAt(0).toUpperCase()+o.slice(1)," wins!"]}),Object(s.jsx)("button",{className:"new-game-button",onClick:c,children:"New Game"})]})})})};const w={king:{white:"\u2654",black:"\u265a"},queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"},pawn:{white:"\u2659",black:"\u265f"}},b=["a","b","c","d","e","f","g","h"],d=["8","7","6","5","4","3","2","1"];var m=e=>{let{currentPlayer:o,gameStatus:c,onMove:r,onNewGame:n,boardHistory:i}=e;const a=Object(t.useCallback)((()=>{const e=[];for(let o=0;o<8;o++){const c=[];for(let e=0;e<8;e++)c.push({piece:S(o,e),color:(o+e)%2===0?"white":"black"});e.push(c)}return e}),[]),[p,m]=Object(t.useState)(a()),[f,j]=Object(t.useState)(null),[k,v]=Object(t.useState)([]),[O,g]=Object(t.useState)({lastMove:null,canEnPassant:null}),[y,x]=Object(t.useState)(null),[N,P]=Object(t.useState)(null),M=Object(t.useRef)(null);function S(e,o){if(e<=1){const c="black";if(1===e)return{type:"pawn",color:c};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:c}}if(e>=6){const c="white";if(6===e)return{type:"pawn",color:c};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:c}}return null}function C(e,o){return"".concat(b[o]).concat(8-e)}function q(e){const o=e.charAt(0).toLowerCase();return{row:8-parseInt(e.charAt(1)),col:b.indexOf(o)}}function E(e,o,c){var t;if("king"===(null===(t=O.lastMove)||void 0===t?void 0:t.piece.type)&&O.lastMove.piece.color===c)return!1;const r="white"===c?7:0;if(e.row!==r||4!==e.col)return!1;const n=p[e.row][e.col].piece,i=p[o.row][o.col].piece;if(!n||!i||"king"!==n.type||"rook"!==i.type)return!1;const s=o.col<e.col?-1:1;for(let l=e.col+s;l!==o.col;l+=s)if(p[r][l].piece)return!1;for(let a=e.col;a!==e.col+3*s;a+=s){const o=p.map((e=>e.map((e=>Object(l.a)({},e)))));if(o[r][a].piece=n,o[r][e.col].piece=null,U(c,o))return!1}return!0}function A(e,o,c){const t=[];switch(o.type){case"pawn":const r="white"===o.color?-1:1,n="white"===o.color?6:1;let i=e.row+r;if(i>=0&&i<8&&!c[i][e.col].piece&&(t.push({row:i,col:e.col}),e.row===n)){const o=e.row+2*r;c[o][e.col].piece||t.push({row:o,col:e.col})}[-1,1].forEach((r=>{const n=e.col+r;if(n>=0&&n<8&&i>=0&&i<8){const e=c[i][n].piece;e&&e.color!==o.color&&t.push({row:i,col:n})}}));break;case"knight":[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]].forEach((r=>{let[n,i]=r;const l=e.row+n,s=e.col+i;if(l>=0&&l<8&&s>=0&&s<8){const e=c[l][s].piece;e&&e.color===o.color||t.push({row:l,col:s})}}));break;case"bishop":[[-1,-1],[-1,1],[1,-1],[1,1]].forEach((r=>{let[n,i]=r,l=e.row+n,s=e.col+i;for(;l>=0&&l<8&&s>=0&&s<8;){const e=c[l][s].piece;if(e){e.color!==o.color&&t.push({row:l,col:s});break}t.push({row:l,col:s}),l+=n,s+=i}}));break;case"rook":[[-1,0],[1,0],[0,-1],[0,1]].forEach((r=>{let[n,i]=r,l=e.row+n,s=e.col+i;for(;l>=0&&l<8&&s>=0&&s<8;){const e=c[l][s].piece;if(e){e.color!==o.color&&t.push({row:l,col:s});break}t.push({row:l,col:s}),l+=n,s+=i}}));break;case"queen":[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].forEach((r=>{let[n,i]=r,l=e.row+n,s=e.col+i;for(;l>=0&&l<8&&s>=0&&s<8;){const e=c[l][s].piece;if(e){e.color!==o.color&&t.push({row:l,col:s});break}t.push({row:l,col:s}),l+=n,s+=i}}));break;case"king":[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].forEach((r=>{let[n,i]=r;const l=e.row+n,s=e.col+i;if(l>=0&&l<8&&s>=0&&s<8){const e=c[l][s].piece;e&&e.color===o.color||t.push({row:l,col:s})}}))}return t}function B(e,o){for(let c=0;c<8;c++)for(let t=0;t<8;t++){const r=o[c][t].piece;if("king"===(null===r||void 0===r?void 0:r.type)&&r.color===e)return{row:c,col:t}}return null}function I(e,o,c){const t="white"===o?1:-1,r=[{row:e.row+t,col:e.col-1},{row:e.row+t,col:e.col+1}];for(const a of r)if(a.row>=0&&a.row<8&&a.col>=0&&a.col<8){const e=c[a.row][a.col].piece;if("pawn"===(null===e||void 0===e?void 0:e.type)&&e.color===o)return!0}const n=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[a,p]of n){const t=e.row+a,r=e.col+p;if(t>=0&&t<8&&r>=0&&r<8){const e=c[t][r].piece;if("knight"===(null===e||void 0===e?void 0:e.type)&&e.color===o)return!0}}const i=[[-1,-1],[-1,1],[1,-1],[1,1]];for(const[a,p]of i){let t=e.row+a,r=e.col+p;for(;t>=0&&t<8&&r>=0&&r<8;){const e=c[t][r].piece;if(e){if(e.color===o&&("bishop"===e.type||"queen"===e.type))return!0;break}t+=a,r+=p}}const l=[[-1,0],[1,0],[0,-1],[0,1]];for(const[a,p]of l){let t=e.row+a,r=e.col+p;for(;t>=0&&t<8&&r>=0&&r<8;){const e=c[t][r].piece;if(e){if(e.color===o&&("rook"===e.type||"queen"===e.type))return!0;break}t+=a,r+=p}}const s=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[a,p]of s){const t=e.row+a,r=e.col+p;if(t>=0&&t<8&&r>=0&&r<8){const e=c[t][r].piece;if("king"===(null===e||void 0===e?void 0:e.type)&&e.color===o)return!0}}return!1}function U(e,o){const c=B(e,o);if(!c)return!1;return I(c,"white"===e?"black":"white",o)}function G(e,o){const c=function(e,o){const c=B(e,o);if(!c)return[];const t=[],r="white"===e?"black":"white",n="white"===r?1:-1,i=[{row:c.row+n,col:c.col-1},{row:c.row+n,col:c.col+1}];for(const a of i)if(a.row>=0&&a.row<8&&a.col>=0&&a.col<8){const e=o[a.row][a.col].piece;"pawn"===(null===e||void 0===e?void 0:e.type)&&e.color===r&&t.push({row:a.row,col:a.col})}const l=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[a,p]of l){const e=c.row+a,n=c.col+p;if(e>=0&&e<8&&n>=0&&n<8){const c=o[e][n].piece;"knight"===(null===c||void 0===c?void 0:c.type)&&c.color===r&&t.push({row:e,col:n})}}const s=[[-1,-1],[-1,1],[1,-1],[1,1],[-1,0],[1,0],[0,-1],[0,1]];for(const[a,p]of s){let e=c.row+a,n=c.col+p;for(;e>=0&&e<8&&n>=0&&n<8;){const c=o[e][n].piece;if(c){if(c.color===r){const o=Math.abs(a)===Math.abs(p);(!o||"bishop"!==c.type&&"queen"!==c.type)&&(o||"rook"!==c.type&&"queen"!==c.type)||t.push({row:e,col:n})}break}e+=a,n+=p}}return t}(e,o);if(0===c.length)return!0;if(c.length>1)return R(e,o);const t=B(e,o),r=c[0],n=o[r.row][r.col].piece.type;if("knight"===n||"pawn"===n)return L(e,r,o)||R(e,o);return function(e,o){const c=[],t=Math.sign(o.row-e.row),r=Math.sign(o.col-e.col);let n=e.row+t,i=e.col+r;for(;n!==o.row||i!==o.col;)c.push({row:n,col:i}),n+=t,i+=r;return c}(t,r).some((c=>V(c,e,o)))||L(e,r,o)||R(e,o)}function V(e,o,c){for(let t=0;t<8;t++)for(let r=0;r<8;r++){const n=c[t][r].piece;if(n&&n.color===o){if(A({row:t,col:r},n,c).some((o=>o.row===e.row&&o.col===e.col))){const n=c.map((e=>e.map((e=>Object(l.a)({},e)))));if(n[e.row][e.col].piece=n[t][r].piece,n[t][r].piece=null,!U(o,n))return!0}}}return!1}function L(e,o,c){return V(o,e,c)}function R(e,o){const c=B(e,o),t=o[c.row][c.col].piece;return A(c,t,o).some((r=>{const n=o.map((e=>e.map((e=>Object(l.a)({},e)))));return n[r.row][r.col].piece=t,n[c.row][c.col].piece=null,!I(r,"white"===e?"black":"white",n)}))}function T(e,o){return!!U(e,o)&&!G(e,o)}function z(e,t){if("checkmate"!==c&&!y)if(f){if(k.some((o=>o.row===e&&o.col===t))){const c=p.map((e=>e.map((e=>Object(l.a)({},e))))),n=c[f.row][f.col].piece,i=c[e][t].piece,s=!!i||"pawn"===n.type&&t!==f.col;if("king"===n.type&&2===Math.abs(t-f.col)){const o=t>f.col?7:0,r=t>f.col?t-1:t+1;c[e][r].piece=c[e][o].piece,c[e][o].piece=null}if("pawn"===n.type&&t!==f.col&&!i){c[f.row][t].piece=null}c[e][t].piece=n,c[f.row][f.col].piece=null,P({from:{row:f.row,col:f.col},to:{row:e,col:t}});const a={lastMove:{piece:n,from:Object(l.a)({},f),to:{row:e,col:t}},canEnPassant:null};if("pawn"===n.type&&2===Math.abs(e-f.row)&&(a.canEnPassant={row:e,col:t}),m(c),g(a),"pawn"===n.type){if("white"===n.color&&0===e||"black"===n.color&&7===e){if(function(e){const o=p[e.row][e.col].piece;if(!o||"pawn"!==o.type)return!1;if(("white"===o.color&&0===e.row||"black"===o.color&&7===e.row)&&M.current){const o=M.current.querySelector('[data-position="'.concat(e.row,"-").concat(e.col,'"]'));if(o){const c=o.getBoundingClientRect(),t=M.current.getBoundingClientRect(),r=c.left-t.left+c.width/2,n=c.top-t.top+c.height/2;return x({position:e,dialogPosition:{x:r,y:n}}),!0}}return!1}({row:e,col:t}))return}}const u="white"===o?"black":"white",h=U(u,c),b=h&&T(u,c),d={piece:w[n.type][n.color],from:C(f.row,f.col),to:C(e,t),capture:s,check:h,checkmate:b};r(d,c)}j(null),v([])}else{const c=p[e][t].piece;c&&c.color===o&&(j({row:e,col:t}),v(function(e,c){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=c[e.row][e.col].piece;if(!r||r.color!==o&&!t)return[];let n=A(e,r,c);if(!t&&("king"!==r.type||U(r.color,c)||(E(e,{row:e.row,col:7},r.color)&&n.push({row:e.row,col:e.col+2}),E(e,{row:e.row,col:0},r.color)&&n.push({row:e.row,col:e.col-2})),"pawn"===r.type&&O.canEnPassant)){const o="white"===r.color?3:4;e.row===o&&[-1,1].forEach((o=>{var c;e.col+o===(null===(c=O.canEnPassant)||void 0===c?void 0:c.col)&&n.push({row:e.row+("white"===r.color?-1:1),col:e.col+o})}))}t||(n=n.filter((o=>{const t=c.map((e=>e.map((e=>Object(l.a)({},e)))));return t[o.row][o.col].piece=t[e.row][e.col].piece,t[e.row][e.col].piece=null,!U(r.color,t)})));return n}({row:e,col:t},p)))}}return Object(t.useEffect)((()=>{if(i.length>0){const e=i[i.length-1];if(m(e.board),e.move){const o=q(e.move.from),c=q(e.move.to);P({from:o,to:c})}}else m(a()),P(null)}),[i,a]),Object(s.jsxs)("div",{className:"chess-board",ref:M,children:[p.map(((e,t)=>Object(s.jsx)("div",{className:"board-row",children:e.map(((e,r)=>{var n;const i=(null===N||void 0===N?void 0:N.from.row)===t&&(null===N||void 0===N?void 0:N.from.col)===r,l=(null===N||void 0===N?void 0:N.to.row)===t&&(null===N||void 0===N?void 0:N.to.col)===r,a="king"===(null===(n=e.piece)||void 0===n?void 0:n.type)&&e.piece.color===o&&"check"===c;return Object(s.jsx)("div",{className:"square ".concat(e.color," ").concat((null===f||void 0===f?void 0:f.row)===t&&(null===f||void 0===f?void 0:f.col)===r?"selected":""," ").concat(k.some((e=>e.row===t&&e.col===r))?"valid-move":""," ").concat(i||l?"last-move":""," ").concat(a?"check":""),"data-position":"".concat(t,"-").concat(r),"data-file":7===t?b[r]:"","data-rank":0===r?d[t]:"",onClick:()=>z(t,r),children:e.piece&&Object(s.jsx)("div",{className:"piece ".concat(l?"piece-moving":""),children:w[e.piece.type][e.piece.color]})},"".concat(t,"-").concat(r))}))},t))),y&&Object(s.jsx)(u,{color:p[y.position.row][y.position.col].piece.color,position:y.dialogPosition,onSelect:function(e){if(!y||!O.lastMove)return;const o=p.map((e=>e.map((e=>Object(l.a)({},e))))),c=o[y.position.row][y.position.col].piece;o[y.position.row][y.position.col].piece={type:e,color:c.color};const t="white"===c.color?"black":"white",n=U(t,o),i=n&&T(t,o),s={piece:w[e][c.color],from:C(O.lastMove.from.row,O.lastMove.from.col),to:C(y.position.row,y.position.col),capture:"pawn"===O.lastMove.piece.type&&O.lastMove.from.col!==y.position.col,check:n,checkmate:i};x(null),r(s,o)}}),"checkmate"===c&&Object(s.jsx)(h,{winner:"white"===o?"black":"white",onNewGame:n})]})};c(15);var f=e=>{let{moves:o}=e;const c=e=>{let o=e.piece;return e.capture&&(o+="x"),o+=e.to,e.checkmate?o+="#":e.check&&(o+="+"),o};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h3",{className:"history-title",children:"Move History"}),Object(s.jsx)("div",{className:"moves-container",children:0===o.length?Object(s.jsx)("div",{className:"no-moves",children:"No moves yet"}):Object(s.jsx)("div",{className:"moves-list",children:o.map(((e,o)=>Object(s.jsxs)("div",{className:"move-entry",children:[Object(s.jsxs)("span",{className:"move-number",children:[Math.floor(o/2)+1,"."]}),Object(s.jsx)("span",{className:"move-text ".concat(o%2===0?"white":"black"),children:c(e)})]},o)))})})]})};c(16);var j=e=>{let{onSelectMode:o,username:c}=e;return Object(s.jsxs)("div",{className:"game-mode-selector",children:[Object(s.jsxs)("h2",{children:["Welcome, ",c,"!"]}),Object(s.jsx)("p",{children:"Choose your game mode:"}),Object(s.jsxs)("div",{className:"mode-buttons",children:[Object(s.jsxs)("button",{className:"mode-button computer",onClick:()=>o("computer"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83e\udd16"}),Object(s.jsx)("span",{className:"label",children:"Play vs Computer"})]}),Object(s.jsxs)("button",{className:"mode-button player",onClick:()=>o("player"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83d\udc65"}),Object(s.jsx)("span",{className:"label",children:"Play vs Player"})]})]})]})};c(17);var k=e=>{let{pieces:o,color:c}=e;const t=e=>({king:{white:"\u2654",black:"\u265a"},queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"},pawn:{white:"\u2659",black:"\u265f"}}[e.type][e.color]),r={queen:9,rook:5,bishop:3,knight:3,pawn:1,king:0},n=[...o].sort(((e,o)=>r[o.type]-r[e.type]));return Object(s.jsxs)("div",{className:"captured-pieces ".concat(c),children:[Object(s.jsxs)("div",{className:"captured-pieces-label",children:["white"===c?"White":"Black"," captures:"]}),Object(s.jsx)("div",{className:"captured-pieces-list",children:n.map(((e,o)=>Object(s.jsx)("span",{className:"captured-piece",children:t(e)},o)))})]})};const v={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:100},O={pawn:[[0,0,0,0,0,0,0,0],[5,5,5,5,5,5,5,5],[1,1,2,3,3,2,1,1],[.5,.5,1,2.5,2.5,1,.5,.5],[0,0,0,2,2,0,0,0],[.5,-.5,-1,0,0,-1,-.5,.5],[.5,1,1,-2,-2,1,1,.5],[0,0,0,0,0,0,0,0]],knight:[[-5,-4,-3,-3,-3,-3,-4,-5],[-4,-2,0,0,0,0,-2,-4],[-3,0,1,1.5,1.5,1,0,-3],[-3,.5,1.5,2,2,1.5,.5,-3],[-3,0,1.5,2,2,1.5,0,-3],[-3,.5,1,1.5,1.5,1,.5,-3],[-4,-2,0,.5,.5,0,-2,-4],[-5,-4,-3,-3,-3,-3,-4,-5]],bishop:[[-2,-1,-1,-1,-1,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,1,1,.5,0,-1],[-1,.5,.5,1,1,.5,.5,-1],[-1,0,1,1,1,1,0,-1],[-1,1,1,1,1,1,1,-1],[-1,.5,0,0,0,0,.5,-1],[-2,-1,-1,-1,-1,-1,-1,-2]],rook:[[0,0,0,0,0,0,0,0],[.5,1,1,1,1,1,1,.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[0,0,0,.5,.5,0,0,0]],queen:[[-2,-1,-1,-.5,-.5,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,.5,.5,.5,0,-1],[-.5,0,.5,.5,.5,.5,0,-.5],[0,0,.5,.5,.5,.5,0,-.5],[-1,.5,.5,.5,.5,.5,0,-1],[-1,0,.5,0,0,0,0,-1],[-2,-1,-1,-.5,-.5,-1,-1,-2]],king:[[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-2,-3,-3,-4,-4,-3,-3,-2],[-1,-2,-2,-2,-2,-2,-2,-1],[2,2,0,0,0,0,2,2],[2,3,1,0,0,1,3,2]]};class g{getValidMoves(e,o,c){const t=[],r={pawn:"white"===o.color?[[-1,0]]:[[1,0]],knight:[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]],bishop:[[-1,-1],[-1,1],[1,-1],[1,1]],rook:[[-1,0],[1,0],[0,-1],[0,1]],queen:[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],king:[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]},n=["bishop","rook","queen"].includes(o.type);if("pawn"===o.type){const r="white"===o.color?-1:1,n="white"===o.color?6:1;return this.isValidPosition(e.row+r,e.col)&&!c[e.row+r][e.col].piece&&(t.push({row:e.row+r,col:e.col}),e.row!==n||c[e.row+2*r][e.col].piece||t.push({row:e.row+2*r,col:e.col})),[-1,1].forEach((n=>{const i=e.row+r,l=e.col+n;if(this.isValidPosition(i,l)){const e=c[i][l].piece;e&&e.color!==o.color&&t.push({row:i,col:l})}})),t}return r[o.type].forEach((r=>{let[i,l]=r,s=e.row+i,a=e.col+l;for(;this.isValidPosition(s,a);){const e=c[s][a];if(e.piece){e.piece.color!==o.color&&t.push({row:s,col:a});break}if(t.push({row:s,col:a}),!n)break;s+=i,a+=l}})),t}isValidPosition(e,o){return e>=0&&e<8&&o>=0&&o<8}evaluatePosition(e){let o=0;for(let c=0;c<8;c++)for(let t=0;t<8;t++){const r=e[c][t].piece;if(r){const e=v[r.type]+O[r.type]["white"===r.color?c:7-c][t];o+="black"===r.color?e:-e}}return o}minimax(e,o,c,t,r){if(0===o)return{score:this.evaluatePosition(e)};const n=[];for(let i=0;i<8;i++)for(let o=0;o<8;o++){const c=e[i][o].piece;if(c&&c.color===(r?"black":"white")){this.getValidMoves({row:i,col:o},c,e).forEach((e=>{n.push({from:{row:i,col:o},to:e})}))}}if(r){let r,i=-1/0;for(const l of n){const n=this.makeMove(e,l),s=this.minimax(n,o-1,c,t,!1);if(s.score>i&&(i=s.score,r=l),t<=(c=Math.max(c,s.score)))break}return{score:i,move:r}}{let r,i=1/0;for(const l of n){const n=this.makeMove(e,l),s=this.minimax(n,o-1,c,t,!0);if(s.score<i&&(i=s.score,r=l),(t=Math.min(t,s.score))<=c)break}return{score:i,move:r}}}makeMove(e,o){const c=e.map((e=>e.map((e=>Object(l.a)({},e)))));return c[o.to.row][o.to.col].piece=c[o.from.row][o.from.col].piece,c[o.from.row][o.from.col].piece=null,c}getBestMove(e){return this.minimax(e,3,-1/0,1/0,!0).move||null}}c(18);var y=e=>{let{username:o}=e;const[c,r]=Object(t.useState)("white"),[n,i]=Object(t.useState)("active"),[a,p]=Object(t.useState)([]),[u,h]=Object(t.useState)([]),[w,b]=Object(t.useState)(!1),[d,v]=Object(t.useState)(null),[O]=Object(t.useState)((()=>new g)),[y,x]=Object(t.useState)({white:[],black:[]}),N=(e,o)=>{if(e<=1){const c="black";if(1===e)return{type:"pawn",color:c};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:c}}if(e>=6){const c="white";if(6===e)return{type:"pawn",color:c};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:c}}return null},P=(e,o)=>"".concat(["a","b","c","d","e","f","g","h"][o]).concat(8-e),M=Object(t.useCallback)(((e,o)=>{p((o=>[...o,e])),r((e=>"white"===e?"black":"white"));const t=e.checkmate?"checkmate":e.check?"check":"active";if(i(t),e.capture){const o=u[u.length-1];if(o){const t=S(e.to),r=o.board[t.row][t.col].piece;if(r){const e="white"===c?"white":"black";x((o=>Object(l.a)(Object(l.a)({},o),{},{[e]:[...o[e],r]})))}}}h((r=>[...r,{board:o,currentPlayer:c,gameStatus:t,move:e}])),b(!0)}),[u,c]);Object(t.useEffect)((()=>{if("computer"===d&&"black"===c){const e=setTimeout((()=>{const e=u[u.length-1];if(e){const c=O.getBestMove(e.board);if(c){var o;const t=P(c.from.row,c.from.col),r=P(c.to.row,c.to.col);M({piece:(null===(o=e.board[c.from.row][c.from.col].piece)||void 0===o?void 0:o.type)||"",from:t,to:r},((e,o)=>{const c=e.map((e=>e.map((e=>Object(l.a)({},e)))));return c[o.to.row][o.to.col].piece=c[o.from.row][o.from.col].piece,c[o.from.row][o.from.col].piece=null,c})(e?e.board:(()=>{const e=[];for(let o=0;o<8;o++){const c=[];for(let e=0;e<8;e++)c.push({piece:N(o,e),color:(o+e)%2===0?"white":"black"});e.push(c)}return e})(),c))}}}),500);return()=>clearTimeout(e)}}),[c,d,u,O,M]);const S=e=>{const o=e.charAt(0).toLowerCase();return{row:8-parseInt(e.charAt(1)),col:o.charCodeAt(0)-"a".charCodeAt(0)}},C=()=>{r("white"),i("active"),p([]),h([]),b(!1),x({white:[],black:[]})};return d?Object(s.jsxs)("div",{className:"chess-game",children:[Object(s.jsxs)("div",{className:"game-info",children:[Object(s.jsxs)("div",{className:"current-player",children:["Current Player: ",c.charAt(0).toUpperCase()+c.slice(1)]}),Object(s.jsxs)("div",{className:"game-controls",children:[Object(s.jsx)("button",{className:"control-button undo-button",onClick:()=>{if(0!==u.length)if("computer"===d){const e=[...a];e.pop(),e.pop(),p(e);const o=[...u];o.pop(),o.pop(),h(o);const c=o[o.length-1];c?(r(c.currentPlayer),i(c.gameStatus)):(r("white"),i("active")),b(o.length>0)}else{const e=[...a];e.pop(),p(e);const o=[...u],c=o.pop();h(o),c&&(r(c.currentPlayer),i(c.gameStatus)),b(o.length>0)}},disabled:!w,title:"Undo last move",children:"\u21a9 Undo"}),Object(s.jsx)("button",{className:"control-button new-game-button",onClick:C,title:"Start a new game",children:"New Game"}),Object(s.jsx)("button",{className:"control-button mode-button",onClick:()=>v(null),title:"Change game mode",children:"Change Mode"})]}),Object(s.jsxs)("div",{className:"game-status",children:["Status: ",n.charAt(0).toUpperCase()+n.slice(1)]}),Object(s.jsxs)("div",{className:"game-mode",children:["Mode: ","computer"===d?"vs Computer":"vs Player"]})]}),Object(s.jsxs)("div",{className:"game-container",children:[Object(s.jsxs)("div",{className:"game-board",children:[Object(s.jsx)(k,{pieces:y.black,color:"black"}),Object(s.jsx)(m,{currentPlayer:c,gameStatus:n,onMove:M,onNewGame:C,boardHistory:u}),Object(s.jsx)(k,{pieces:y.white,color:"white"})]}),Object(s.jsx)("div",{className:"move-history",children:Object(s.jsx)(f,{moves:a})})]})]}):Object(s.jsx)(j,{username:o,onSelectMode:v})};var x=()=>{const[e,o]=Object(t.useState)(""),[c,r]=Object(t.useState)(!1),[n,i]=Object(t.useState)(null),[l,a]=Object(t.useState)(!0),p=e=>{console.log("Incomplete payment found:",e)};return Object(t.useEffect)((()=>{console.log("Initializing Pi SDK...");const e=setTimeout((()=>{(async()=>{a(!0),i(null);try{if(!window.Pi)throw new Error("Pi Network SDK not loaded. Please make sure you are accessing this app through the Pi Browser.");console.log("Starting Pi authentication...");const e=await window.Pi.authenticate(["username","payments"],{onIncompletePaymentFound:p});console.log("Authentication successful:",e),o(e.user.username),r(!0)}catch(e){console.error("Authentication failed:",e);let o="Failed to authenticate with Pi Network";e.message&&(o+=": ".concat(e.message)),e.response&&(console.error("Response data:",e.response.data),console.error("Response status:",e.response.status)),i(o)}finally{a(!1)}})()}),1e3);return()=>clearTimeout(e)}),[]),l?Object(s.jsx)("div",{children:"Connecting to Pi Network..."}):n?Object(s.jsxs)("div",{children:[Object(s.jsx)("h2",{children:"Error"}),Object(s.jsx)("p",{children:n}),Object(s.jsx)("p",{children:"Please make sure you are:"}),Object(s.jsxs)("ul",{children:[Object(s.jsx)("li",{children:"Using the Pi Browser"}),Object(s.jsx)("li",{children:"Your app is properly configured in the Pi Developer Portal"}),Object(s.jsx)("li",{children:"You have a stable internet connection"})]})]}):Object(s.jsx)("div",{children:c?Object(s.jsx)(y,{username:e}):Object(s.jsxs)("div",{children:[Object(s.jsx)("h2",{children:"Welcome to Pi Chess"}),Object(s.jsx)("p",{children:"Please wait while we connect to Pi Network..."})]})})};window.Pi&&window.Pi.init({version:"2.0",sandbox:!0}),i.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(x,{})}),document.getElementById("root"))}],[[19,1,2]]]);
//# sourceMappingURL=main.35118e62.chunk.js.map