(this["webpackJsonpapp-platform-demo-frontend"]=this["webpackJsonpapp-platform-demo-frontend"]||[]).push([[0],[,,,,function(e,o,t){},,,,,,,,function(e,o,t){},function(e,o,t){},function(e,o,t){},,function(e,o,t){},function(e,o,t){},function(e,o,t){},function(e,o,t){},function(e,o,t){},function(e,o,t){},function(e,o,t){"use strict";t.r(o);var c=t(1),n=t.n(c),r=t(5),l=t.n(r),i=(t(11),t(12),t(2)),s=(t(13),t(14),t(0));const a={queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"}},u={queen:"Moves any number of squares diagonally, horizontally, or vertically",rook:"Moves any number of squares horizontally or vertically",bishop:"Moves any number of squares diagonally",knight:"Moves in an L-shape: 2 squares in one direction and 1 square perpendicular"};var p=e=>{let{color:o,position:t,onSelect:n}=e;return Object(c.useEffect)((()=>{const e=e=>{"Escape"===e.key&&n("queen")};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[n]),Object(s.jsx)("div",{className:"promotion-overlay",children:Object(s.jsxs)("div",{className:"promotion-dialog",style:{position:"absolute",left:"".concat(t.x,"px"),top:"".concat(t.y,"px"),transform:"translate(-50%, -50%)",animation:"slideIn 0.3s ease-out"},role:"dialog","aria-modal":"true","aria-label":"Pawn promotion selection",children:[Object(s.jsx)("div",{className:"promotion-header",children:"Choose a piece for promotion"}),Object(s.jsx)("div",{className:"promotion-options",children:["queen","rook","bishop","knight"].map((e=>Object(s.jsxs)("button",{className:"promotion-option",onClick:()=>n(e),title:u[e],"aria-label":"Promote to ".concat(e),children:[Object(s.jsx)("div",{className:"piece-symbol",children:a[e][o]}),Object(s.jsx)("div",{className:"piece-name",children:e.toUpperCase()})]},e)))}),Object(s.jsx)("div",{className:"promotion-footer",children:"Press ESC to cancel (default: Queen)"})]})})};t(16);var d=e=>{let{winner:o,onNewGame:t}=e;return Object(s.jsx)("div",{className:"checkmate-overlay",children:Object(s.jsx)("div",{className:"checkmate-popup",children:Object(s.jsxs)("div",{className:"checkmate-content",children:[Object(s.jsx)("h2",{children:"Checkmate!"}),Object(s.jsxs)("p",{children:[o.charAt(0).toUpperCase()+o.slice(1)," wins!"]}),Object(s.jsx)("button",{className:"new-game-button",onClick:t,children:"New Game"})]})})})};const h={king:{white:"\u2654",black:"\u265a"},queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"},pawn:{white:"\u2659",black:"\u265f"}},m=["a","b","c","d","e","f","g","h"],b=["8","7","6","5","4","3","2","1"];var w=e=>{let{currentPlayer:o,gameStatus:t,onMove:n,onNewGame:r,boardHistory:l}=e;const a=Object(c.useCallback)((()=>{const e=[];for(let o=0;o<8;o++){const t=[];for(let e=0;e<8;e++)t.push({piece:P(o,e),color:(o+e)%2===0?"white":"black"});e.push(t)}return e}),[]),[u,w]=Object(c.useState)(a()),[j,f]=Object(c.useState)(null),[v,k]=Object(c.useState)([]),[O,y]=Object(c.useState)({lastMove:null,canEnPassant:null}),[g,x]=Object(c.useState)(null),[N,E]=Object(c.useState)(null),S=Object(c.useRef)(null);function P(e,o){if(e<=1){const t="black";if(1===e)return{type:"pawn",color:t};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:t}}if(e>=6){const t="white";if(6===e)return{type:"pawn",color:t};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:t}}return null}function C(e,o){return"".concat(m[o]).concat(8-e)}function M(e){const o=e.charAt(0).toLowerCase();return{row:8-parseInt(e.charAt(1)),col:m.indexOf(o)}}function q(e,o,t){var c;if("king"===(null===(c=O.lastMove)||void 0===c?void 0:c.piece.type)&&O.lastMove.piece.color===t)return!1;const n="white"===t?7:0;if(e.row!==n||4!==e.col)return!1;const r=u[e.row][e.col].piece,l=u[o.row][o.col].piece;if(!r||!l||"king"!==r.type||"rook"!==l.type)return!1;const s=o.col<e.col?-1:1;for(let i=e.col+s;i!==o.col;i+=s)if(u[n][i].piece)return!1;for(let a=e.col;a!==e.col+3*s;a+=s){const o=u.map((e=>e.map((e=>Object(i.a)({},e)))));if(o[n][a].piece=r,o[n][e.col].piece=null,A(t,o))return!1}return!0}function F(e,o,t){const c=[];switch(o.type){case"pawn":const n="white"===o.color?-1:1,r="white"===o.color?6:1;let l=e.row+n;if(l>=0&&l<8&&!t[l][e.col].piece&&(c.push({row:l,col:e.col}),e.row===r)){const o=e.row+2*n;t[o][e.col].piece||c.push({row:o,col:e.col})}[-1,1].forEach((n=>{const r=e.col+n;if(r>=0&&r<8&&l>=0&&l<8){const e=t[l][r].piece;e&&e.color!==o.color&&c.push({row:l,col:r})}}));break;case"knight":[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]].forEach((n=>{let[r,l]=n;const i=e.row+r,s=e.col+l;if(i>=0&&i<8&&s>=0&&s<8){const e=t[i][s].piece;e&&e.color===o.color||c.push({row:i,col:s})}}));break;case"bishop":[[-1,-1],[-1,1],[1,-1],[1,1]].forEach((n=>{let[r,l]=n,i=e.row+r,s=e.col+l;for(;i>=0&&i<8&&s>=0&&s<8;){const e=t[i][s].piece;if(e){e.color!==o.color&&c.push({row:i,col:s});break}c.push({row:i,col:s}),i+=r,s+=l}}));break;case"rook":[[-1,0],[1,0],[0,-1],[0,1]].forEach((n=>{let[r,l]=n,i=e.row+r,s=e.col+l;for(;i>=0&&i<8&&s>=0&&s<8;){const e=t[i][s].piece;if(e){e.color!==o.color&&c.push({row:i,col:s});break}c.push({row:i,col:s}),i+=r,s+=l}}));break;case"queen":[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].forEach((n=>{let[r,l]=n,i=e.row+r,s=e.col+l;for(;i>=0&&i<8&&s>=0&&s<8;){const e=t[i][s].piece;if(e){e.color!==o.color&&c.push({row:i,col:s});break}c.push({row:i,col:s}),i+=r,s+=l}}));break;case"king":[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].forEach((n=>{let[r,l]=n;const i=e.row+r,s=e.col+l;if(i>=0&&i<8&&s>=0&&s<8){const e=t[i][s].piece;e&&e.color===o.color||c.push({row:i,col:s})}}))}return c}function G(e,o){for(let t=0;t<8;t++)for(let c=0;c<8;c++){const n=o[t][c].piece;if("king"===(null===n||void 0===n?void 0:n.type)&&n.color===e)return{row:t,col:c}}return null}function L(e,o,t){const c="white"===o?1:-1,n=[{row:e.row+c,col:e.col-1},{row:e.row+c,col:e.col+1}];for(const a of n)if(a.row>=0&&a.row<8&&a.col>=0&&a.col<8){const e=t[a.row][a.col].piece;if("pawn"===(null===e||void 0===e?void 0:e.type)&&e.color===o)return!0}const r=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[a,u]of r){const c=e.row+a,n=e.col+u;if(c>=0&&c<8&&n>=0&&n<8){const e=t[c][n].piece;if("knight"===(null===e||void 0===e?void 0:e.type)&&e.color===o)return!0}}const l=[[-1,-1],[-1,1],[1,-1],[1,1]];for(const[a,u]of l){let c=e.row+a,n=e.col+u;for(;c>=0&&c<8&&n>=0&&n<8;){const e=t[c][n].piece;if(e){if(e.color===o&&("bishop"===e.type||"queen"===e.type))return!0;break}c+=a,n+=u}}const i=[[-1,0],[1,0],[0,-1],[0,1]];for(const[a,u]of i){let c=e.row+a,n=e.col+u;for(;c>=0&&c<8&&n>=0&&n<8;){const e=t[c][n].piece;if(e){if(e.color===o&&("rook"===e.type||"queen"===e.type))return!0;break}c+=a,n+=u}}const s=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(const[a,u]of s){const c=e.row+a,n=e.col+u;if(c>=0&&c<8&&n>=0&&n<8){const e=t[c][n].piece;if("king"===(null===e||void 0===e?void 0:e.type)&&e.color===o)return!0}}return!1}function A(e,o){const t=G(e,o);if(!t)return!1;return L(t,"white"===e?"black":"white",o)}function B(e,o){const t=function(e,o){const t=G(e,o);if(!t)return[];const c=[],n="white"===e?"black":"white",r="white"===n?1:-1,l=[{row:t.row+r,col:t.col-1},{row:t.row+r,col:t.col+1}];for(const a of l)if(a.row>=0&&a.row<8&&a.col>=0&&a.col<8){const e=o[a.row][a.col].piece;"pawn"===(null===e||void 0===e?void 0:e.type)&&e.color===n&&c.push({row:a.row,col:a.col})}const i=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]];for(const[a,u]of i){const e=t.row+a,r=t.col+u;if(e>=0&&e<8&&r>=0&&r<8){const t=o[e][r].piece;"knight"===(null===t||void 0===t?void 0:t.type)&&t.color===n&&c.push({row:e,col:r})}}const s=[[-1,-1],[-1,1],[1,-1],[1,1],[-1,0],[1,0],[0,-1],[0,1]];for(const[a,u]of s){let e=t.row+a,r=t.col+u;for(;e>=0&&e<8&&r>=0&&r<8;){const t=o[e][r].piece;if(t){if(t.color===n){const o=Math.abs(a)===Math.abs(u);(!o||"bishop"!==t.type&&"queen"!==t.type)&&(o||"rook"!==t.type&&"queen"!==t.type)||c.push({row:e,col:r})}break}e+=a,r+=u}}return c}(e,o);if(0===t.length)return!0;if(t.length>1)return z(e,o);const c=G(e,o),n=t[0],r=o[n.row][n.col].piece.type;if("knight"===r||"pawn"===r)return I(e,n,o)||z(e,o);return function(e,o){const t=[],c=Math.sign(o.row-e.row),n=Math.sign(o.col-e.col);let r=e.row+c,l=e.col+n;for(;r!==o.row||l!==o.col;)t.push({row:r,col:l}),r+=c,l+=n;return t}(c,n).some((t=>R(t,e,o)))||I(e,n,o)||z(e,o)}function R(e,o,t){for(let c=0;c<8;c++)for(let n=0;n<8;n++){const r=t[c][n].piece;if(r&&r.color===o){if(F({row:c,col:n},r,t).some((o=>o.row===e.row&&o.col===e.col))){const r=t.map((e=>e.map((e=>Object(i.a)({},e)))));if(r[e.row][e.col].piece=r[c][n].piece,r[c][n].piece=null,!A(o,r))return!0}}}return!1}function I(e,o,t){return R(o,e,t)}function z(e,o){const t=G(e,o),c=o[t.row][t.col].piece;return F(t,c,o).some((n=>{const r=o.map((e=>e.map((e=>Object(i.a)({},e)))));return r[n.row][n.col].piece=c,r[t.row][t.col].piece=null,!L(n,"white"===e?"black":"white",r)}))}function V(e,o){return!!A(e,o)&&!B(e,o)}function W(e,c){if("checkmate"!==t&&!g)if(j){if(v.some((o=>o.row===e&&o.col===c))){const t=u.map((e=>e.map((e=>Object(i.a)({},e))))),r=t[j.row][j.col].piece,l=t[e][c].piece,s=!!l||"pawn"===r.type&&c!==j.col;if("king"===r.type&&2===Math.abs(c-j.col)){const o=c>j.col?7:0,n=c>j.col?c-1:c+1;t[e][n].piece=t[e][o].piece,t[e][o].piece=null}if("pawn"===r.type&&c!==j.col&&!l){t[j.row][c].piece=null}t[e][c].piece=r,t[j.row][j.col].piece=null,E({from:{row:j.row,col:j.col},to:{row:e,col:c}});const a={lastMove:{piece:r,from:Object(i.a)({},j),to:{row:e,col:c}},canEnPassant:null};if("pawn"===r.type&&2===Math.abs(e-j.row)&&(a.canEnPassant={row:e,col:c}),w(t),y(a),"pawn"===r.type){if("white"===r.color&&0===e||"black"===r.color&&7===e){if(function(e){const o=u[e.row][e.col].piece;if(!o||"pawn"!==o.type)return!1;if(("white"===o.color&&0===e.row||"black"===o.color&&7===e.row)&&S.current){const o=S.current.querySelector('[data-position="'.concat(e.row,"-").concat(e.col,'"]'));if(o){const t=o.getBoundingClientRect(),c=S.current.getBoundingClientRect(),n=t.left-c.left+t.width/2,r=t.top-c.top+t.height/2;return x({position:e,dialogPosition:{x:n,y:r}}),!0}}return!1}({row:e,col:c}))return}}const p="white"===o?"black":"white",d=A(p,t),m=d&&V(p,t),b={piece:h[r.type][r.color],from:C(j.row,j.col),to:C(e,c),capture:s,check:d,checkmate:m};n(b,t)}f(null),k([])}else{const t=u[e][c].piece;t&&t.color===o&&(f({row:e,col:c}),k(function(e,t){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t[e.row][e.col].piece;if(!n||n.color!==o&&!c)return[];let r=F(e,n,t);if(!c&&("king"!==n.type||A(n.color,t)||(q(e,{row:e.row,col:7},n.color)&&r.push({row:e.row,col:e.col+2}),q(e,{row:e.row,col:0},n.color)&&r.push({row:e.row,col:e.col-2})),"pawn"===n.type&&O.canEnPassant)){const o="white"===n.color?3:4;e.row===o&&[-1,1].forEach((o=>{var t;e.col+o===(null===(t=O.canEnPassant)||void 0===t?void 0:t.col)&&r.push({row:e.row+("white"===n.color?-1:1),col:e.col+o})}))}c||(r=r.filter((o=>{const c=t.map((e=>e.map((e=>Object(i.a)({},e)))));return c[o.row][o.col].piece=c[e.row][e.col].piece,c[e.row][e.col].piece=null,!A(n.color,c)})));return r}({row:e,col:c},u)))}}return Object(c.useEffect)((()=>{if(l.length>0){const e=l[l.length-1];if(w(e.board),e.move){const o=M(e.move.from),t=M(e.move.to);E({from:o,to:t})}}else w(a()),E(null)}),[l,a]),Object(s.jsxs)("div",{className:"chess-board",ref:S,children:[u.map(((e,c)=>Object(s.jsx)("div",{className:"board-row",children:e.map(((e,n)=>{var r;const l=(null===N||void 0===N?void 0:N.from.row)===c&&(null===N||void 0===N?void 0:N.from.col)===n,i=(null===N||void 0===N?void 0:N.to.row)===c&&(null===N||void 0===N?void 0:N.to.col)===n,a="king"===(null===(r=e.piece)||void 0===r?void 0:r.type)&&e.piece.color===o&&"check"===t;return Object(s.jsx)("div",{className:"square ".concat(e.color," ").concat((null===j||void 0===j?void 0:j.row)===c&&(null===j||void 0===j?void 0:j.col)===n?"selected":""," ").concat(v.some((e=>e.row===c&&e.col===n))?"valid-move":""," ").concat(l||i?"last-move":""," ").concat(a?"check":""),"data-position":"".concat(c,"-").concat(n),"data-file":7===c?m[n]:"","data-rank":0===n?b[c]:"",onClick:()=>W(c,n),children:e.piece&&Object(s.jsx)("div",{className:"piece ".concat(i?"piece-moving":""),children:h[e.piece.type][e.piece.color]})},"".concat(c,"-").concat(n))}))},c))),g&&Object(s.jsx)(p,{color:u[g.position.row][g.position.col].piece.color,position:g.dialogPosition,onSelect:function(e){if(!g||!O.lastMove)return;const o=u.map((e=>e.map((e=>Object(i.a)({},e))))),t=o[g.position.row][g.position.col].piece;o[g.position.row][g.position.col].piece={type:e,color:t.color};const c="white"===t.color?"black":"white",r=A(c,o),l=r&&V(c,o),s={piece:h[e][t.color],from:C(O.lastMove.from.row,O.lastMove.from.col),to:C(g.position.row,g.position.col),capture:"pawn"===O.lastMove.piece.type&&O.lastMove.from.col!==g.position.col,check:r,checkmate:l};x(null),n(s,o)}}),"checkmate"===t&&Object(s.jsx)(d,{winner:"white"===o?"black":"white",onNewGame:r})]})};t(17);var j=e=>{let{moves:o}=e;const t=e=>{let o=e.piece;return e.capture&&(o+="x"),o+=e.to,e.checkmate?o+="#":e.check&&(o+="+"),o};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h3",{className:"history-title",children:"Move History"}),Object(s.jsx)("div",{className:"moves-container",children:0===o.length?Object(s.jsx)("div",{className:"no-moves",children:"No moves yet"}):Object(s.jsx)("div",{className:"moves-list",children:o.map(((e,o)=>Object(s.jsxs)("div",{className:"move-entry",children:[Object(s.jsxs)("span",{className:"move-number",children:[Math.floor(o/2)+1,"."]}),Object(s.jsx)("span",{className:"move-text ".concat(o%2===0?"white":"black"),children:t(e)})]},o)))})})]})};t(18);var f=e=>{let{onSelect:o,username:t}=e;const[n,r]=Object(c.useState)(null),[l,i]=Object(c.useState)("standard"),a=e=>{r(e)},u=e=>{i(e)};return null===n?Object(s.jsxs)("div",{className:"game-mode-selector",children:[Object(s.jsxs)("h2",{children:["Welcome, ",t,"!"]}),Object(s.jsx)("p",{children:"Choose your game mode:"}),Object(s.jsxs)("div",{className:"mode-buttons",children:[Object(s.jsxs)("button",{className:"mode-button player",onClick:()=>a("player"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83d\udc65"}),Object(s.jsx)("span",{className:"label",children:"Play vs Human"})]}),Object(s.jsxs)("button",{className:"mode-button computer",onClick:()=>a("computer"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83e\udd16"}),Object(s.jsx)("span",{className:"label",children:"Play vs Computer"})]})]})]}):Object(s.jsxs)("div",{className:"game-mode-selector",children:[Object(s.jsx)("h2",{children:"Game Settings"}),Object(s.jsxs)("div",{className:"game-settings",children:[Object(s.jsxs)("div",{className:"setting-group",children:[Object(s.jsx)("h3",{children:"Game Mode"}),Object(s.jsxs)("div",{className:"mode-buttons",children:[Object(s.jsxs)("button",{className:"mode-button ".concat("player"===n?"active":""),onClick:()=>a("player"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83d\udc65"}),Object(s.jsx)("span",{className:"label",children:"vs Human"})]}),Object(s.jsxs)("button",{className:"mode-button ".concat("computer"===n?"active":""),onClick:()=>a("computer"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83e\udd16"}),Object(s.jsx)("span",{className:"label",children:"vs Computer"})]})]})]}),Object(s.jsxs)("div",{className:"setting-group",children:[Object(s.jsx)("h3",{children:"Game Variant"}),Object(s.jsxs)("div",{className:"variant-buttons",children:[Object(s.jsxs)("button",{className:"variant-button ".concat("standard"===l?"active":""),onClick:()=>u("standard"),children:[Object(s.jsx)("span",{className:"icon",children:"\u265f\ufe0f"}),Object(s.jsx)("span",{className:"label",children:"Standard"})]}),Object(s.jsxs)("button",{className:"variant-button pi-competitive ".concat("pi_competitive"===l?"active":""),onClick:()=>u("pi_competitive"),children:[Object(s.jsx)("span",{className:"icon",children:"\ud83e\ude99"}),Object(s.jsxs)("div",{className:"details",children:[Object(s.jsx)("span",{className:"label",children:"Play for \u03c0"}),Object(s.jsx)("span",{className:"entry-fee",children:"0.01\u03c0 entry"}),Object(s.jsx)("span",{className:"prize-pool",children:"Win: 0.018\u03c0"})]})]})]})]})]}),Object(s.jsxs)("div",{className:"action-buttons",children:[Object(s.jsx)("button",{className:"back-button",onClick:()=>r(null),children:"Back"}),Object(s.jsx)("button",{className:"start-button",onClick:()=>{n&&o(n,l)},disabled:!n,children:"Start Game"})]})]})};t(19);var v=e=>{let{pieces:o,color:t}=e;const c=e=>({king:{white:"\u2654",black:"\u265a"},queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"},pawn:{white:"\u2659",black:"\u265f"}}[e.type][e.color]),n={queen:9,rook:5,bishop:3,knight:3,pawn:1,king:0},r=[...o].sort(((e,o)=>n[o.type]-n[e.type]));return Object(s.jsxs)("div",{className:"captured-pieces ".concat(t),children:[Object(s.jsxs)("div",{className:"captured-pieces-label",children:["white"===t?"White":"Black"," captures:"]}),Object(s.jsx)("div",{className:"captured-pieces-list",children:r.map(((e,o)=>Object(s.jsx)("span",{className:"captured-piece",children:c(e)},o)))})]})};const k={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:100},O={pawn:[[0,0,0,0,0,0,0,0],[5,5,5,5,5,5,5,5],[1,1,2,3,3,2,1,1],[.5,.5,1,2.5,2.5,1,.5,.5],[0,0,0,2,2,0,0,0],[.5,-.5,-1,0,0,-1,-.5,.5],[.5,1,1,-2,-2,1,1,.5],[0,0,0,0,0,0,0,0]],knight:[[-5,-4,-3,-3,-3,-3,-4,-5],[-4,-2,0,0,0,0,-2,-4],[-3,0,1,1.5,1.5,1,0,-3],[-3,.5,1.5,2,2,1.5,.5,-3],[-3,0,1.5,2,2,1.5,0,-3],[-3,.5,1,1.5,1.5,1,.5,-3],[-4,-2,0,.5,.5,0,-2,-4],[-5,-4,-3,-3,-3,-3,-4,-5]],bishop:[[-2,-1,-1,-1,-1,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,1,1,.5,0,-1],[-1,.5,.5,1,1,.5,.5,-1],[-1,0,1,1,1,1,0,-1],[-1,1,1,1,1,1,1,-1],[-1,.5,0,0,0,0,.5,-1],[-2,-1,-1,-1,-1,-1,-1,-2]],rook:[[0,0,0,0,0,0,0,0],[.5,1,1,1,1,1,1,.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[0,0,0,.5,.5,0,0,0]],queen:[[-2,-1,-1,-.5,-.5,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,.5,.5,.5,0,-1],[-.5,0,.5,.5,.5,.5,0,-.5],[0,0,.5,.5,.5,.5,0,-.5],[-1,.5,.5,.5,.5,.5,0,-1],[-1,0,.5,0,0,0,0,-1],[-2,-1,-1,-.5,-.5,-1,-1,-2]],king:[[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-2,-3,-3,-4,-4,-3,-3,-2],[-1,-2,-2,-2,-2,-2,-2,-1],[2,2,0,0,0,0,2,2],[2,3,1,0,0,1,3,2]]};class y{getValidMoves(e,o,t){const c=[],n={pawn:"white"===o.color?[[-1,0]]:[[1,0]],knight:[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]],bishop:[[-1,-1],[-1,1],[1,-1],[1,1]],rook:[[-1,0],[1,0],[0,-1],[0,1]],queen:[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],king:[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]]},r=["bishop","rook","queen"].includes(o.type);if("pawn"===o.type){const n="white"===o.color?-1:1,r="white"===o.color?6:1;return this.isValidPosition(e.row+n,e.col)&&!t[e.row+n][e.col].piece&&(c.push({row:e.row+n,col:e.col}),e.row!==r||t[e.row+2*n][e.col].piece||c.push({row:e.row+2*n,col:e.col})),[-1,1].forEach((r=>{const l=e.row+n,i=e.col+r;if(this.isValidPosition(l,i)){const e=t[l][i].piece;e&&e.color!==o.color&&c.push({row:l,col:i})}})),c}return n[o.type].forEach((n=>{let[l,i]=n,s=e.row+l,a=e.col+i;for(;this.isValidPosition(s,a);){const e=t[s][a];if(e.piece){e.piece.color!==o.color&&c.push({row:s,col:a});break}if(c.push({row:s,col:a}),!r)break;s+=l,a+=i}})),c}isValidPosition(e,o){return e>=0&&e<8&&o>=0&&o<8}evaluatePosition(e){let o=0;for(let t=0;t<8;t++)for(let c=0;c<8;c++){const n=e[t][c].piece;if(n){const e=k[n.type]+O[n.type]["white"===n.color?t:7-t][c];o+="black"===n.color?e:-e}}return o}minimax(e,o,t,c,n){if(0===o)return{score:this.evaluatePosition(e)};const r=[];for(let l=0;l<8;l++)for(let o=0;o<8;o++){const t=e[l][o].piece;if(t&&t.color===(n?"black":"white")){this.getValidMoves({row:l,col:o},t,e).forEach((e=>{r.push({from:{row:l,col:o},to:e})}))}}if(n){let n,l=-1/0;for(const i of r){const r=this.makeMove(e,i),s=this.minimax(r,o-1,t,c,!1);if(s.score>l&&(l=s.score,n=i),c<=(t=Math.max(t,s.score)))break}return{score:l,move:n}}{let n,l=1/0;for(const i of r){const r=this.makeMove(e,i),s=this.minimax(r,o-1,t,c,!0);if(s.score<l&&(l=s.score,n=i),(c=Math.min(c,s.score))<=t)break}return{score:l,move:n}}}makeMove(e,o){const t=e.map((e=>e.map((e=>Object(i.a)({},e)))));return t[o.to.row][o.to.col].piece=t[o.from.row][o.from.col].piece,t[o.from.row][o.from.col].piece=null,t}getBestMove(e){return this.minimax(e,3,-1/0,1/0,!0).move||null}}var g=t(6);t(20);const x=["isFullscreen","toggleFullscreen"];var N=e=>{let{isFullscreen:o,toggleFullscreen:t}=e,c=Object(g.a)(e,x);return Object(s.jsx)("button",Object(i.a)(Object(i.a)({type:"button",className:"fullscreen-button",onClick:t,"aria-label":o?"Exit fullscreen":"Enter fullscreen",title:o?"Exit fullscreen":"Enter fullscreen"},c),{},{children:o?"\u2935\ufe0f":"\u2934\ufe0f"}))};t(4);var E=e=>{let{onComplete:o,onError:t}=e;const[n,r]=Object(c.useState)(!1),[l,i]=Object(c.useState)("idle");return Object(s.jsxs)("div",{className:"pi-payment-flow",children:[Object(s.jsx)("h3",{children:"Play for Pi"}),Object(s.jsx)("p",{children:"Entry fee: 0.01 \u03c0"}),Object(s.jsx)("p",{children:"Winner gets: 0.018 \u03c0 (0.002 \u03c0 fee)"}),"idle"===l&&Object(s.jsx)("button",{className:"pi-pay-button",onClick:async()=>{if(n||"undefined"===typeof Pi)t(new Error("Pi Browser is required for this feature"));else try{r(!0),i("pending"),Pi.init({version:"2.0"});const e={amount:.01,memo:"Chess Game Entry Fee",metadata:{gameType:"chess",timestamp:Date.now()}};Pi.createPayment(e,{onReadyForServerApproval:e=>{console.log("Payment approved on client, waiting for server approval",e),o(e),i("completed")},onReadyForServerCompletion:(e,t)=>{console.log("Payment completed",{paymentId:e,txid:t}),i("completed"),o(e)},onCancel:()=>{console.log("Payment was cancelled by user"),i("failed"),t(new Error("Payment was cancelled")),r(!1)},onError:e=>{console.error("Payment error:",e),i("failed"),t(new Error("Payment processing error")),r(!1)}})}catch(e){console.error("Error initializing payment:",e),i("failed"),t(new Error("Failed to initialize payment")),r(!1)}},disabled:n,children:n?"Processing...":"Pay 0.01 \u03c0 to Play"}),"pending"===l&&Object(s.jsxs)("div",{className:"payment-status pending",children:[Object(s.jsx)("p",{children:"Processing payment..."}),Object(s.jsx)("p",{children:"Please check your Pi Wallet"})]}),"completed"===l&&Object(s.jsx)("div",{className:"payment-status success",children:Object(s.jsx)("p",{children:"Payment successful! Starting game..."})}),"failed"===l&&Object(s.jsxs)("div",{className:"payment-status error",children:[Object(s.jsx)("p",{children:"Payment failed. Please try again."}),Object(s.jsx)("button",{onClick:()=>i("idle"),children:"Retry"})]})]})};const S=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),P=async()=>{try{if(q()&&M())return await window.screen.orientation.lock("landscape"),!0}catch(e){console.warn("Failed to lock orientation:",e),M()&&F()}return!1},C=async()=>{try{q()&&await window.screen.orientation.unlock(),document.documentElement.style.transform="",document.documentElement.style.width="",document.documentElement.style.height=""}catch(e){console.warn("Failed to unlock orientation:",e)}},M=()=>window.matchMedia("(orientation: portrait)").matches,q=()=>{var e;return"screen"in window&&"orientation"in window.screen&&"function"===typeof(null===(e=window.screen.orientation)||void 0===e?void 0:e.lock)},F=()=>{if(M()){window.orientation;const e=window.innerWidth,o=window.innerHeight;document.documentElement.style.width="".concat(o,"px"),document.documentElement.style.height="".concat(e,"px"),document.documentElement.style.transform="rotate(90deg) translate(".concat((o-e)/2,"px, ").concat((o-e)/2,"px)"),document.documentElement.style.transformOrigin="center center",document.documentElement.style.overflow="hidden",document.body.style.width="".concat(o,"px"),document.body.style.height="".concat(e,"px"),document.body.style.overflow="hidden"}};t(21);const G=e=>{const o=e.charCodeAt(0)-"a".charCodeAt(0);return{row:8-parseInt(e[1],10),col:o}},L=(e,o)=>"".concat("abcdefgh"[o]).concat(8-e);var A=e=>{let{username:o}=e;const[t,n]=Object(c.useState)("active"),[r,l]=Object(c.useState)("white"),[a,u]=Object(c.useState)(!1),[p,d]=Object(c.useState)([]),[h,m]=Object(c.useState)([]),[b,k]=Object(c.useState)(!1),[O,g]=Object(c.useState)(null),[x,M]=Object(c.useState)("standard"),[q,F]=Object(c.useState)(!1),[A,B]=Object(c.useState)(!1),[R,I]=Object(c.useState)(0),[z,V]=Object(c.useState)(null),[W,D]=Object(c.useState)(null),[H,J]=Object(c.useState)(!1),[T,U]=Object(c.useState)(!1),[_,Q]=Object(c.useState)("white"),[K,X]=Object(c.useState)({white:[],black:[]}),Y=Object(c.useRef)(null),[Z]=Object(c.useState)((()=>new y)),$=()=>{U(!!document.fullscreenElement)};Object(c.useEffect)((()=>(document.addEventListener("fullscreenchange",$),()=>{document.removeEventListener("fullscreenchange",$)})),[]),Object(c.useEffect)((()=>{a?P().catch(console.error):C().catch(console.error)}),[a]),Object(c.useEffect)((()=>{if("computer"===O&&"black"===r){const e=setTimeout((()=>{const e=h[h.length-1],o=Z.getBestMove(e?e.board:ee());if(o){const t=L(o.from.row,o.from.col),c=L(o.to.row,o.to.col),n=null===e||void 0===e?void 0:e.board[o.from.row][o.from.col].piece;if(n){const r=e?e.board:ee(),l={piece:te(n.type,n.color),from:t,to:c},i=ce(r,{row:o.from.row,col:o.from.col},{row:o.to.row,col:o.to.col});ne(l,i)}}}),500);return()=>clearTimeout(e)}}),[r,O,h]);const ee=()=>{const e=[];for(let o=0;o<8;o++){const t=[];for(let e=0;e<8;e++)t.push({piece:oe(o,e),color:(o+e)%2===0?"white":"black"});e.push(t)}return e},oe=(e,o)=>{if(e<=1){const t="black";if(1===e)return{type:"pawn",color:t};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:t}}if(e>=6){const t="white";if(6===e)return{type:"pawn",color:t};return{type:["rook","knight","bishop","queen","king","bishop","knight","rook"][o],color:t}}return null},te=(e,o)=>({king:{white:"\u2654",black:"\u265a"},queen:{white:"\u2655",black:"\u265b"},rook:{white:"\u2656",black:"\u265c"},bishop:{white:"\u2657",black:"\u265d"},knight:{white:"\u2658",black:"\u265e"},pawn:{white:"\u2659",black:"\u265f"}}[e][o]),ce=(e,o,t)=>{const c=JSON.parse(JSON.stringify(e));return c[t.row][t.col].piece=c[o.row][o.col].piece,c[o.row][o.col].piece=null,c},ne=Object(c.useCallback)(((e,o)=>{const c=G(e.from),n=G(e.to),s=JSON.parse(JSON.stringify(o));s[n.row][n.col].piece=s[c.row][c.col].piece,s[c.row][c.col].piece=null,e.promotion&&s[n.row][n.col].piece&&(s[n.row][n.col].piece.type=e.promotion),de(s);const a="white"===r?"black":"white";l(a);const u=Object(i.a)(Object(i.a)({},e),{},{piece:e.piece||"pawn"});d((e=>[...e,u]));const p={board:s,currentPlayer:a,gameStatus:t,move:u};m((e=>[...e,p])),k(!0),"computer"===O&&"black"===a&&setTimeout((()=>{const e=Z.getBestMove(s);if(e){const o=L(e.from.row,e.from.col),t=L(e.to.row,e.to.col);ne({from:o,to:t,piece:"pawn",capture:!1,check:!1,checkmate:!1},s)}}),500)}),[r,t,O,h,Z]),re=Object(c.useCallback)(((e,o)=>{g(e),M(o),"pi_competitive"===o?I(.02):ae(e,o)}),[]),le=Object(c.useCallback)((e=>{V(e),F(!0),setTimeout((()=>{B(!0),ae(O,x)}),2e3)}),[O,x]),ie=Object(c.useCallback)((e=>{console.error("Payment error:",e),D(e.message||"Payment failed. Please try again."),J(!1)}),[]),se=Object(c.useCallback)((e=>{if(console.log("Game ended with result: ".concat(e)),"draw"===e)console.log("Returning 0.01\u03c0 to each player");else{const o=e;console.log("Sending ".concat(R,"\u03c0 to ").concat(o))}}),[R]),ae=Object(c.useCallback)((function(e){n("active"),l("white"),d([]),m([]),k(!1),X({white:[],black:[]}),u(!0),D(null),S()&&P().catch(console.warn)}),[]),ue=Object(c.useCallback)((e=>{const o=e.winner||(e.isDraw?"draw":void 0);console.log("Game over! ".concat("draw"===o?"Draw!":"Winner: ".concat(o))),"pi_competitive"===x&&R>0&&o&&"draw"!==o&&se(o),setTimeout((()=>{u(!1),g(null),M("standard"),F(!1),B(!1),I(0)}),3e3)}),[x,R,se]),[pe,de]=Object(c.useState)((()=>ee())),[he,me]=Object(c.useState)(null),[be,we]=Object(c.useState)([]),[je,fe]=Object(c.useState)(null);Object(c.useCallback)(((e,o)=>{if("active"!==t||"computer"===O&&"black"===r)return;const c=pe[e][o].piece;if(c&&c.color===r){me({row:e,col:o});we([])}if(he){const t=pe[he.row][he.col].piece;if(t){const c={from:L(he.row,he.col),to:L(e,o),piece:t.type};0!==e&&7!==e||"pawn"!==t.type?ne(c,pe):fe(c),me(null),we([])}}}),[pe,r,t,O,he]),Object(c.useCallback)((e=>{var o;if(!je)return;const t=Object(i.a)(Object(i.a)({},je),{},{piece:(null===(o=pe[G(je.from).row][G(je.from).col].piece)||void 0===o?void 0:o.type)||"pawn",promotion:e});ne(t,pe),fe(null)}),[je,pe]),Object(c.useCallback)((()=>{ue({winner:"white"===r?"black":"white"})}),[r]),Object(c.useCallback)((()=>{if("computer"===O){Math.random()>.5?ue({isDraw:!0}):console.log("Draw declined")}else ue({isDraw:!0})}),[O]);return Object(c.useEffect)((()=>{const e=()=>{U(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}}),[]),Object(c.useEffect)((()=>{if(S()&&O){P().catch((e=>{console.warn("Could not lock orientation:",e)}));const e=()=>{S()&&P().catch(console.warn)};return window.addEventListener("orientationchange",e),window.addEventListener("resize",e),()=>{window.removeEventListener("orientationchange",e),window.removeEventListener("resize",e),C().catch(console.warn)}}}),[O]),a?Object(s.jsxs)("div",{className:"chess-game ".concat(T?"fullscreen":""),ref:Y,children:[Object(s.jsxs)("div",{className:"game-controls",children:[Object(s.jsxs)("div",{className:"control-buttons",children:[Object(s.jsx)("button",{className:"control-button undo-button",onClick:()=>{if(0!==h.length)if("computer"===O){const e=[...p];e.pop(),e.pop(),d(e);const o=[...h];o.pop(),o.pop(),m(o);const t=o[o.length-1];t?(l(t.currentPlayer),n(t.gameStatus)):(l("white"),n("active")),k(o.length>0)}else{const e=[...p];e.pop(),d(e);const o=[...h],t=o.pop();m(o),t&&(l(t.currentPlayer),n(t.gameStatus)),k(o.length>0)}},disabled:!b,title:"Undo last move",children:"\u21a9 Undo"}),Object(s.jsx)("button",{className:"control-button new-game-button",onClick:()=>ae(O),title:"Start a new game",children:"New Game"}),Object(s.jsx)("button",{className:"control-button mode-button",onClick:()=>g(null),title:"Change game mode",children:"Change Mode"}),Object(s.jsx)(N,{isFullscreen:T,toggleFullscreen:()=>{!document.fullscreenElement&&Y.current?(Y.current.requestFullscreen().catch((e=>{console.error("Error attempting to enable fullscreen:",e)})),U(!0)):document.exitFullscreen&&(document.exitFullscreen().catch((e=>{console.error("Error attempting to exit fullscreen:",e)})),U(!1))}})]}),Object(s.jsxs)("div",{className:"game-status",children:["Status: ",t.charAt(0).toUpperCase()+t.slice(1)]}),Object(s.jsxs)("div",{className:"game-mode",children:["Mode: ","computer"===O?"vs Computer":"vs Player"]})]}),Object(s.jsxs)("div",{className:"game-container",children:[Object(s.jsxs)("div",{className:"game-board",children:[Object(s.jsx)(v,{pieces:K.black,color:"black"}),Object(s.jsx)(w,{currentPlayer:r,gameStatus:t,onMove:ne,onNewGame:()=>ae(O),boardHistory:h}),Object(s.jsx)(v,{pieces:K.white,color:"white"})]}),Object(s.jsx)("div",{className:"move-history",children:Object(s.jsx)(j,{moves:p})})]})]}):"pi_competitive"!==x||q?Object(s.jsx)("div",{className:"game-container",ref:Y,children:Object(s.jsx)(f,{username:o||"Player",onSelect:re})}):Object(s.jsx)("div",{className:"game-container",ref:Y,children:Object(s.jsxs)("div",{className:"payment-flow-container",children:[Object(s.jsx)(E,{onComplete:le,onError:ie}),W&&Object(s.jsx)("div",{className:"error-message",children:W}),H&&Object(s.jsx)("div",{className:"loading-spinner",children:"Loading..."})]})})};var B=()=>{const[e,o]=Object(c.useState)(""),[t,n]=Object(c.useState)(!1),[r,l]=Object(c.useState)(!0),i=e=>{console.log("Incomplete payment found:",e)};return Object(c.useEffect)((()=>{(async()=>{try{if(window.Pi){const e=await window.Pi.authenticate(["username"],i);o(e.user.username),n(!0)}}catch(e){console.error("Authentication error:",e)}finally{l(!1)}})()}),[]),t?Object(s.jsx)(A,{username:e}):Object(s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#f5f7fa"},children:Object(s.jsxs)("div",{style:{padding:"20px",borderRadius:"10px",backgroundColor:"white",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",textAlign:"center"},children:[Object(s.jsx)("h2",{children:"Connecting to Pi Network..."}),Object(s.jsx)("p",{children:"Please wait while we authenticate your Pi account."})]})})};window.Pi&&(window.Pi.init={sandbox:!0}),l.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(B,{})}),document.getElementById("root"))}],[[22,1,2]]]);